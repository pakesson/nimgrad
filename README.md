# Nimgrad

A Nim implementation of Andrej Karpathy's [micrograd](https://github.com/karpathy/micrograd)
engine.

Nimgrad implements backpropagation (reverse-mode automatic differentiation)
with a dynamic computational graph for scalar values.

## Example: Moons

```
$ nim c -d:release -r examples/example_moons_mlp.nim
Number of parameters: 337
Train split size: 70
Test split size: 30
Loss: 1.285555352212852
Accuracy: 0.3
Step 1, loss 1.285555352212852, accuracy 30.0%
Step 2, loss 0.422987389276592, accuracy 82.85714285714285%
Step 3, loss 0.6361889548930386, accuracy 77.14285714285714%
Step 4, loss 0.5754982973533248, accuracy 77.14285714285714%
Step 5, loss 0.9244318910568724, accuracy 80.0%
Step 6, loss 0.4862031868517664, accuracy 81.42857142857143%
Step 7, loss 0.371901862063808, accuracy 81.42857142857143%
Step 8, loss 0.3300561618504145, accuracy 82.85714285714285%
Step 9, loss 0.3157103796531935, accuracy 82.85714285714285%
Step 10, loss 0.3062285277632149, accuracy 81.42857142857143%
Step 11, loss 0.2996263818963752, accuracy 84.28571428571429%
Step 12, loss 0.2945634583051136, accuracy 84.28571428571429%
Step 13, loss 0.2954835384246126, accuracy 85.71428571428571%
Step 14, loss 0.3159033362436897, accuracy 87.14285714285714%
Step 15, loss 0.2937498816575315, accuracy 85.71428571428571%
Step 16, loss 0.2910510386716899, accuracy 87.14285714285714%
Step 17, loss 0.2810713051857322, accuracy 87.14285714285714%
Step 18, loss 0.2807925529910597, accuracy 85.71428571428571%
Step 19, loss 0.2751455958110962, accuracy 85.71428571428571%
Step 20, loss 0.2729246369360324, accuracy 87.14285714285714%
Step 21, loss 0.2715878559392997, accuracy 87.14285714285714%
Step 22, loss 0.2680932528574071, accuracy 85.71428571428571%
Step 23, loss 0.2661788621275721, accuracy 87.14285714285714%
Step 24, loss 0.263866742623098, accuracy 85.71428571428571%
Step 25, loss 0.2618125610459252, accuracy 85.71428571428571%
Step 26, loss 0.2597282678296881, accuracy 85.71428571428571%
Step 27, loss 0.2583357631997483, accuracy 85.71428571428571%
Step 28, loss 0.2568285427051135, accuracy 85.71428571428571%
Step 29, loss 0.2588476883230035, accuracy 87.14285714285714%
Step 30, loss 0.2588509751760119, accuracy 88.57142857142857%
Step 31, loss 0.266433323054295, accuracy 87.14285714285714%
Step 32, loss 0.267460815806442, accuracy 90.0%
Step 33, loss 0.2477739168780111, accuracy 87.14285714285714%
Step 34, loss 0.244165593755387, accuracy 87.14285714285714%
Step 35, loss 0.2510075497349879, accuracy 87.14285714285714%
Step 36, loss 0.2590438159851498, accuracy 90.0%
Step 37, loss 0.2422995286556896, accuracy 87.14285714285714%
Step 38, loss 0.2387926980578131, accuracy 90.0%
Step 39, loss 0.233410006015083, accuracy 88.57142857142857%
Step 40, loss 0.2370487270495936, accuracy 90.0%
Step 41, loss 0.231063253774714, accuracy 87.14285714285714%
Step 42, loss 0.2329023020127847, accuracy 90.0%
Step 43, loss 0.2220950785935254, accuracy 88.57142857142857%
Step 44, loss 0.2156573361030421, accuracy 90.0%
Step 45, loss 0.2153523185741698, accuracy 90.0%
Step 46, loss 0.2193940961031133, accuracy 91.42857142857143%
Step 47, loss 0.2123735735481545, accuracy 88.57142857142857%
Step 48, loss 0.2172870498991699, accuracy 92.85714285714285%
Step 49, loss 0.2042293702744762, accuracy 88.57142857142857%
Step 50, loss 0.1993160972748058, accuracy 92.85714285714285%
Step 51, loss 0.1938623864366186, accuracy 90.0%
Step 52, loss 0.1888274151604407, accuracy 92.85714285714285%
Step 53, loss 0.1882183953927083, accuracy 91.42857142857143%
Step 54, loss 0.189274357090635, accuracy 92.85714285714285%
Step 55, loss 0.1838837960840798, accuracy 92.85714285714285%
Step 56, loss 0.178773725862013, accuracy 92.85714285714285%
Step 57, loss 0.1634393207292333, accuracy 92.85714285714285%
Step 58, loss 0.1574862302711879, accuracy 94.28571428571428%
Step 59, loss 0.151321273194251, accuracy 95.71428571428571%
Step 60, loss 0.1449171114719182, accuracy 97.14285714285714%
Step 61, loss 0.1392885358279469, accuracy 98.57142857142857%
Step 62, loss 0.1366479889780304, accuracy 98.57142857142857%
Step 63, loss 0.1556839221481522, accuracy 97.14285714285714%
Step 64, loss 0.1943022333481646, accuracy 92.85714285714285%
Step 65, loss 0.146031131604798, accuracy 95.71428571428571%
Step 66, loss 0.1380699225591139, accuracy 94.28571428571428%
Step 67, loss 0.1256653848977369, accuracy 97.14285714285714%
Step 68, loss 0.1215046583713935, accuracy 98.57142857142857%
Step 69, loss 0.1136988819693422, accuracy 98.57142857142857%
Step 70, loss 0.1045966434047404, accuracy 98.57142857142857%
Step 71, loss 0.1024846827630701, accuracy 98.57142857142857%
Step 72, loss 0.1013461954671172, accuracy 98.57142857142857%
Step 73, loss 0.101970088795181, accuracy 98.57142857142857%
Step 74, loss 0.09266626493940044, accuracy 100.0%
Step 75, loss 0.08678907864315445, accuracy 98.57142857142857%
Step 76, loss 0.09054729457389674, accuracy 98.57142857142857%
Step 77, loss 0.08084100486921258, accuracy 100.0%
Step 78, loss 0.07628086032780457, accuracy 100.0%
Step 79, loss 0.07665271861968792, accuracy 100.0%
Step 80, loss 0.09126777029515004, accuracy 98.57142857142857%
Step 81, loss 0.0758777443585535, accuracy 100.0%
Step 82, loss 0.07992358671431662, accuracy 98.57142857142857%
Step 83, loss 0.06908885355717959, accuracy 100.0%
Step 84, loss 0.07142653422707441, accuracy 100.0%
Step 85, loss 0.06507473303134284, accuracy 100.0%
Step 86, loss 0.06423033737235657, accuracy 100.0%
Step 87, loss 0.06370792900364025, accuracy 100.0%
Step 88, loss 0.06070147518194738, accuracy 100.0%
Step 89, loss 0.06016453012517488, accuracy 100.0%
Step 90, loss 0.05972407633071893, accuracy 100.0%
Step 91, loss 0.05699052606019135, accuracy 100.0%
Step 92, loss 0.05626706835141689, accuracy 100.0%
Step 93, loss 0.05535487358734092, accuracy 100.0%
Step 94, loss 0.05450087403268996, accuracy 100.0%
Step 95, loss 0.05408311533113084, accuracy 100.0%
Step 96, loss 0.05294761753675223, accuracy 100.0%
Step 97, loss 0.05238111100562727, accuracy 100.0%
Step 98, loss 0.05148504939329258, accuracy 100.0%
Step 99, loss 0.05047418448571631, accuracy 100.0%
Step 100, loss 0.04991717571531464, accuracy 100.0%
Test split:
Loss: 0.01108179063678234
Accuracy: 100.0%
```